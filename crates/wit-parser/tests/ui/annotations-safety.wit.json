{
  "worlds": [],
  "interfaces": [
    {
      "name": "safety-examples",
      "types": {
        "safe-path": 0,
        "credentials": 1,
        "secure-connection": 2,
        "access-level": 3
      },
      "functions": {
        "[constructor]secure-connection": {
          "name": "[constructor]secure-connection",
          "kind": {
            "constructor": 2
          },
          "params": [
            {
              "name": "host",
              "type": "string"
            },
            {
              "name": "port",
              "type": "u16"
            }
          ],
          "result": 7,
          "annotations": {
            "contents": [
              {
                "label": "validate_host",
                "value": ""
              },
              {
                "label": "require_tls",
                "value": ""
              }
            ]
          }
        },
        "[method]secure-connection.send-encrypted": {
          "name": "[method]secure-connection.send-encrypted",
          "kind": {
            "method": 2
          },
          "params": [
            {
              "name": "self",
              "type": 4
            },
            {
              "name": "payload",
              "type": 5
            }
          ],
          "result": "bool",
          "annotations": {
            "contents": [
              {
                "label": "encrypt",
                "value": "algorithm = \"aes-256-gcm\""
              },
              {
                "label": "non_null",
                "value": "payload"
              },
              {
                "label": "max_size",
                "value": "payload, 65536"
              }
            ]
          }
        },
        "[method]secure-connection.receive-encrypted": {
          "name": "[method]secure-connection.receive-encrypted",
          "kind": {
            "method": 2
          },
          "params": [
            {
              "name": "self",
              "type": 4
            }
          ],
          "result": 6,
          "annotations": {
            "contents": [
              {
                "label": "decrypt",
                "value": ""
              },
              {
                "label": "verify_signature",
                "value": ""
              }
            ]
          }
        },
        "[method]secure-connection.disconnect": {
          "name": "[method]secure-connection.disconnect",
          "kind": {
            "method": 2
          },
          "params": [
            {
              "name": "self",
              "type": 4
            }
          ],
          "annotations": {
            "contents": [
              {
                "label": "audit_log",
                "value": ""
              },
              {
                "label": "inject_after",
                "value": "\"security::log_disconnect(&self.host);\""
              }
            ]
          }
        },
        "delete-user": {
          "name": "delete-user",
          "kind": "freestanding",
          "params": [
            {
              "name": "user-id",
              "type": "u64"
            }
          ],
          "result": "bool",
          "annotations": {
            "contents": [
              {
                "label": "authorize",
                "value": "level = \"admin\""
              },
              {
                "label": "audit_log",
                "value": ""
              },
              {
                "label": "rate_limit",
                "value": "10, per_minute"
              }
            ]
          }
        },
        "render-user-content": {
          "name": "render-user-content",
          "kind": "freestanding",
          "params": [
            {
              "name": "input",
              "type": "string"
            }
          ],
          "result": "string",
          "annotations": {
            "contents": [
              {
                "label": "escape_html",
                "value": ""
              },
              {
                "label": "sanitize",
                "value": "mode = \"html\""
              },
              {
                "label": "max_length",
                "value": "input, 10000"
              }
            ]
          }
        },
        "compare-secrets": {
          "name": "compare-secrets",
          "kind": "freestanding",
          "params": [
            {
              "name": "a",
              "type": "string"
            },
            {
              "name": "b",
              "type": "string"
            }
          ],
          "result": "bool",
          "annotations": {
            "contents": [
              {
                "label": "constant_time",
                "value": ""
              },
              {
                "label": "no_short_circuit",
                "value": ""
              }
            ]
          }
        },
        "get-random-number": {
          "name": "get-random-number",
          "kind": "freestanding",
          "params": [],
          "result": "u32",
          "annotations": {
            "contents": [
              {
                "label": "test_only",
                "value": ""
              },
              {
                "label": "mock_return",
                "value": "42"
              }
            ]
          }
        }
      },
      "docs": {
        "contents": "Security & safety:\n    - #sanitize, #validate_on_construct, #no_path_traversal for input sanitization\n    - #zeroize_on_drop, #sensitive for secure data handling\n    - #encrypt, #decrypt, #verify_signature for cryptography\n    - #audit_log, #authorize, #constant_time for security operations\n    - #test_only, #mock_return for testing"
      },
      "package": 0
    }
  ],
  "types": [
    {
      "name": "safe-path",
      "kind": {
        "record": {
          "fields": [
            {
              "name": "path",
              "type": "string",
              "annotations": {
                "contents": [
                  {
                    "label": "sanitize",
                    "value": "mode = \"path\""
                  },
                  {
                    "label": "no_path_traversal",
                    "value": ""
                  },
                  {
                    "label": "max_length",
                    "value": "4096"
                  }
                ]
              }
            }
          ]
        }
      },
      "owner": {
        "interface": 0
      },
      "annotations": {
        "contents": [
          {
            "label": "derive",
            "value": "Debug"
          },
          {
            "label": "validate_on_construct",
            "value": ""
          }
        ]
      }
    },
    {
      "name": "credentials",
      "kind": {
        "record": {
          "fields": [
            {
              "name": "token",
              "type": "string",
              "annotations": {
                "contents": [
                  {
                    "label": "non_empty",
                    "value": ""
                  },
                  {
                    "label": "validate_base64",
                    "value": ""
                  }
                ]
              }
            },
            {
              "name": "expires-in",
              "type": "u32",
              "annotations": {
                "contents": [
                  {
                    "label": "range",
                    "value": "1, 3600"
                  }
                ]
              }
            }
          ]
        }
      },
      "owner": {
        "interface": 0
      },
      "annotations": {
        "contents": [
          {
            "label": "derive",
            "value": "Debug, Clone"
          },
          {
            "label": "zeroize_on_drop",
            "value": ""
          },
          {
            "label": "sensitive",
            "value": ""
          }
        ]
      }
    },
    {
      "name": "secure-connection",
      "kind": "resource",
      "owner": {
        "interface": 0
      },
      "annotations": {
        "contents": [
          {
            "label": "derive",
            "value": "Debug"
          }
        ]
      }
    },
    {
      "name": "access-level",
      "kind": {
        "enum": {
          "cases": [
            {
              "name": "guest",
              "annotations": {
                "contents": [
                  {
                    "label": "min_privilege",
                    "value": ""
                  }
                ]
              }
            },
            {
              "name": "user"
            },
            {
              "name": "admin"
            },
            {
              "name": "super-admin",
              "annotations": {
                "contents": [
                  {
                    "label": "require_mfa",
                    "value": ""
                  }
                ]
              }
            }
          ]
        }
      },
      "owner": {
        "interface": 0
      },
      "annotations": {
        "contents": [
          {
            "label": "derive",
            "value": "Debug, Copy, Clone"
          },
          {
            "label": "repr",
            "value": "u8"
          }
        ]
      }
    },
    {
      "name": null,
      "kind": {
        "handle": {
          "borrow": 2
        }
      },
      "owner": null
    },
    {
      "name": null,
      "kind": {
        "list": "u8"
      },
      "owner": null
    },
    {
      "name": null,
      "kind": {
        "option": 5
      },
      "owner": null
    },
    {
      "name": null,
      "kind": {
        "handle": {
          "own": 2
        }
      },
      "owner": null
    }
  ],
  "packages": [
    {
      "name": "test:annotations-safety",
      "interfaces": {
        "safety-examples": 0
      },
      "worlds": {}
    }
  ]
}